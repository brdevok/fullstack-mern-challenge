"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _database=require("../database/database");var _Auth=_interopRequireDefault(require("../libs/apis/Auth"));var _ErrorHandler=_interopRequireDefault(require("../libs/apis/ErrorHandler"));var _jsonwebtoken=_interopRequireDefault(require("jsonwebtoken"));var _JWT=require("../assets/JWT");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _default=app=>{const entry="/auth";app.post(`${entry}/parents/sign-in`,async(req,res)=>{try{const auth=await _Auth.default.signIn(_database.Parent,req.body);if(auth){const token=_jsonwebtoken.default.sign({auth:true,isParent:true,id:auth},_JWT.JWT_PRIVATE_KEY,{expiresIn:60*60});res.json({token})}else{res.sendStatus(403)}}catch(e){res.json(_ErrorHandler.default.response(e.message))}});app.post(`${entry}/childrens/sign-in`,async(req,res)=>{try{const auth=await _Auth.default.signIn(_database.Children,req.body);if(auth){const token=_jsonwebtoken.default.sign({auth:true,id:auth},_JWT.JWT_PRIVATE_KEY,{expiresIn:60*60});res.json({token})}else{res.sendStatus(403)}}catch(e){res.json(_ErrorHandler.default.response(e.message))}})};exports.default=_default;